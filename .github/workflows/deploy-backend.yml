name: Deploy Backend to Railway

on:
  push:
    branches:
      - main
      - master
  workflow_dispatch:

permissions:
  contents: read

jobs:
  notify-railway:
    name: Notify Railway to Redeploy
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Trigger Railway Redeployment
        run: |
          echo "Railway will automatically redeploy when changes are pushed"
          echo "Backend URL: https://web-production-7f5e4.up.railway.app"
          echo "No manual trigger needed - Railway watches this GitHub repo"
        if: always()

      - name: Verify Backend Health
        run: |
          echo "Waiting for backend to be ready..."
          sleep 5
          curl -s https://web-production-7f5e4.up.railway.app/api/teams \
            -H "Accept: application/json" \
            || echo "Backend is starting up..."
        continue-on-error: true
